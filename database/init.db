DROP TABLE IF EXISTS people cascade;
DROP TABLE IF EXISTS chessclubs cascade;
DROP TABLE IF EXISTS chessplayers cascade;
DROP TABLE IF EXISTS federations cascade;
DROP TABLE EXISTS users cascade;
DROP TABLE EXISTS ratings cascade;

CREATE TABLE federations(id VARCHAR(255) PRIMARY KEY);
CREATE TABLE chessclubs(id VARCHAR(255) PRIMARY KEY);
CREATE TABLE people(id SERIAL PRIMARY KEY, firstname VARCHAR(255) NOT NULL, lastname VARCHAR(255) NOT NULL, birthyear SMALLINT NOT NULL, gender VARCHAR(8) NOT NULL DEFAULT 'male');
CREATE TABLE users(email VARCHAR(255) PRIMARY KEY, password VARCHAR(255) NOT NULL, people_id INTEGER NOT NULL, FOREIGN KEY(people_id) REFERENCES people(id) ON DELETE CASCADE ON UPDATE CASCADE);
CREATE TABLE chessplayers (id INTEGER NOT NULL, user_email VARCHAR(255) NOT NULL, chessclub_id VARCHAR(255) NOT NULL, federation_id VARCHAR(255) NOT NULL, people_id INTEGER NOT NULL, PRIMARY KEY(user_email, id), FOREIGN KEY(user_email) REFERENCES users(email) ON DELETE CASCADE ON UPDATE CASCADE, FOREIGN KEY(chessclub_id) REFERENCES chessclubs(id) ON DELETE CASCADE ON UPDATE CASCADE, FOREIGN KEY(federation_id) REFERENCES federations(id) ON DELETE CASCADE ON UPDATE CASCADE, FOREIGN KEY(people_id) REFERENCES people(id) ON DELETE CASCADE ON UPDATE CASCADE);


