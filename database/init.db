DROP TABLE IF EXISTS people cascade;
DROP TABLE IF EXISTS chessclubs cascade;
DROP TABLE IF EXISTS chessplayers cascade;
DROP TABLE IF EXISTS federations cascade;

CREATE TABLE federations (id VARCHAR(255) PRIMARY KEY);
CREATE TABLE chessclubs (id VARCHAR(255) PRIMARY KEY);
CREATE TABLE people (id SERIAL PRIMARY KEY, firstname VARCHAR(255) NOT NULL, lastname VARCHAR(255) NOT NULL, birthyear SMALLINT NOT NULL, gender VARCHAR(8) NOT NULL DEFAULT 'male');
CREATE TABLE chessplayers (id INTEGER PRIMARY KEY, chessclub_id VARCHAR(255) NOT NULL, federation_id VARCHAR(255) NOT NULL, people_id INTEGER NOT NULL, FOREIGN KEY(chessclub_id) REFERENCES chessclubs(id) ON DELETE CASCADE ON UPDATE CASCADE, FOREIGN KEY(federation_id) REFERENCES federations(id) ON DELETE CASCADE ON UPDATE CASCADE, FOREIGN KEY(people_id) REFERENCES people(id) ON DELETE CASCADE ON UPDATE CASCADE);
CREATE TABLE ratings(chessplayer_id INTEGER NOT NULL, rating_date DATE NOT NULL DEFAULT CURRENT_DATE, standard SMALLINT NOT NULL DEFAULT 0, rapid SMALLINT NOT NULL DEFAULT 0, blitz SMALLINT NOT NULL DEFAULT 0, FOREIGN KEY(chessplayer_id) REFERENCES chessplayers(id) ON DELETE CASCADE ON UPDATE CASCADE, PRIMARY KEY(chessplayer_id, rating_date));


